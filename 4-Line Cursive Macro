Sub CreateCursiveGuideWithColumns()
    ' Input dialog for user to specify parameters
    Dim startX As Double, startY As Double
    Dim width As Double, rows As Integer, columns As Integer, gutter As Double
    startX = CDbl(InputBox("Enter the starting X position (in mm):", "Start X", 10))
    startY = CDbl(InputBox("Enter the starting Y position (in mm):", "Start Y", 10))
    width = CDbl(InputBox("Enter the width of each 4-line set (in mm):", "Width", 210)) ' Default width for A4 page
    rows = CInt(InputBox("Enter the number of rows:", "Rows", 10))
    columns = CInt(InputBox("Enter the number of columns:", "Columns", 5))
    gutter = CDbl(InputBox("Enter the gutter space between each row (in mm):", "Gutter", 8))

    ' Convert mm to document units (CorelDRAW often uses inches internally)
    startX = startX * 0.0393701 ' Convert mm to inches
    startY = startY * 0.0393701
    width = width * 0.0393701
    gutter = gutter * 0.0393701

    Dim doc As Document
    Set doc = ActiveDocument

    ' Calculate the width of each column based on the total width and number of columns
    Dim columnWidth As Double
    columnWidth = width / columns

    ' Define colors
    Dim red As Color
    Set red = CreateCMYKColor(0, 100, 100, 0) ' Red color for top and bottom lines

    Dim lightBlue As Color
    Set lightBlue = CreateCMYKColor(30, 0, 0, 0) ' Light blue for middle lines

    Dim lightPurple As Color
    Set lightPurple = CreateCMYKColor(30, 30, 0, 0) ' Light purple for column dividers

    ' Create the 4-line guide for each row with a fixed height of 4mm between each line
    Dim i As Integer, j As Integer, x As Double, y As Double
    y = startY ' Starting Y position
    x = startX ' Starting X position

    For i = 1 To rows
        ' Draw the top line
        ActiveLayer.CreateLineSegment(x, y, x + width, y).Outline.Color = red
        ' Draw the first middle line (4mm below top line)
        ActiveLayer.CreateLineSegment(x, y - (4 * 0.0393701), x + width, y - (4 * 0.0393701)).Outline.Color = lightBlue
        ' Draw the second middle line (8mm below top line)
        ActiveLayer.CreateLineSegment(x, y - (8 * 0.0393701), x + width, y - (8 * 0.0393701)).Outline.Color = lightBlue
        ' Draw the bottom line (12mm below top line)
        ActiveLayer.CreateLineSegment(x, y - (12 * 0.0393701), x + width, y - (12 * 0.0393701)).Outline.Color = red

        ' Move to the next row position (12mm total height)
        y = y - (12 * 0.0393701) - gutter ' This ensures each 4-line set is 12mm tall, with specified gutter spacing
    Next i

' Draw column dividers
Dim columnPosition As Double
columnPosition = startX + columnWidth

For j = 1 To columns - 1 ' Draw dividers between columns, stopping before the last column
    ' Draw a vertical line from the top of the first set to the bottom of the last set's bottom line
    ActiveLayer.CreateLineSegment(columnPosition, startY, columnPosition, y + (12 * 0.0265)).Outline.Color = lightPurple
    columnPosition = columnPosition + columnWidth ' Move to the next column position
Next j

    MsgBox "Cursive 4-line guides with columns created successfully!"
End Sub



